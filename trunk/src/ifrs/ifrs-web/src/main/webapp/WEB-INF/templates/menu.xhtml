<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	<h:form id="form_menu">
		<!-- p:growl id="growl" autoUpdate="true"  /-->
		<p:ajaxStatus onstart="statusDialog.show();" oncomplete="statusDialog.hide();" />
		<ui:include src="/WEB-INF/templates/ajax-dialog-template.xhtml" />
		
			
		<p:panel header="#{msg.label_seleccione_empresa}">  		
        	<p:selectOneMenu  id="somEmp1"  value="#{menuBackingBean.idRut}" valueChangeListener="#{menuBackingBean.empresaChangeValue}"  immediate="true">
				<f:selectItem itemLabel="#{msg.label_seleccione}" />
				<f:selectItems value="#{componenteBackingBean.empresaList}" var="empresa" itemValue="#{empresa.idRut}" itemLabel="#{empresa.razonSocial}" />
				<f:ajax execute="@this" render="@form"/>
			</p:selectOneMenu>	
        </p:panel>
		
		<p:accordionPanel activeIndex="#{menuBackingBean.activeTabIndex}" id="ap_menu">			
			<p:tab title="#{msg.label_tab_proceso}" id="m1" rendered="#{menuBackingBean.root.childCount > 0}">			    				
				<p:tree id="treeSingle" value="#{menuBackingBean.root}" var="nodo"    
					selectionMode="single" style="border: 0px; width:95%; margin-left:-30px; float:left;">
					<p:ajax event="select" update="@form" listener="#{menuBackingBean.onSelectNodeMenuCuadro}" />  
					<p:treeNode>
					    <p:commandLink onstart="statusDialog.show();" oncomplete="statusDialog.hide();" ajax="true" value="#{menuBackingBean.catalogoMap[nodo].nombre == null ? nodo : menuBackingBean.catalogoMap[nodo].nombre}"/>											    		
					</p:treeNode>
				</p:tree>
			</p:tab>
			
			<c:forEach items="${menuBackingBean.menuModelList}" var="row" varStatus="status">
				<p:tab title="#{row.menuParent.nombre}" id="m2_${status.count}">					
					<ul>
						<ui:repeat var="rowChild" value="#{row.menuChild}">							
							<li style="margin-left:-40px;">
								<h:commandLink id="cl1" value="#{rowChild.nombre}" action="#{menuBackingBean.navigation}" style="text-decoration: none;"  onmouseover="javascript:this.style.color='SlateGray';" onmouseout="javascript:this.style.color='black';" >
									<f:param name="urlAction" value="#{rowChild.urlMenu}"/>
									<f:param name="tabNumber" value="${status.count}"/>									
								</h:commandLink>
							</li>																	
						</ui:repeat>
					</ul>					
				</p:tab>
			</c:forEach>
			
		</p:accordionPanel>
	</h:form>
</ui:composition>