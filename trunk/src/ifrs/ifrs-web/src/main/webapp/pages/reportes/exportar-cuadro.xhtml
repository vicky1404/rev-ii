<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/main-template.xhtml">
	<ui:define name="content">
		<h:outputScript name="js/util/form-util.js" />
		<h:form id="f_reporte_cuadro">
			<p:growl id="messages_reporte_cuadro" autoUpdate="true"
				showDetail="true" showSummary="true" />
			<p:ajaxStatus onstart="statusDialog.show();"
				oncomplete="statusDialog.hide();" />
			<ui:include src="/WEB-INF/templates/ajax-dialog-template.xhtml" />

			<!-- dialogo de descarga word -->
			<p:dialog id="popUpDownWord" header="#{msg.label_descargar}"
				widgetVar="p_down_word" width="300" height="50" modal="false"
				draggable="false" resizable="false">
				<h:panelGrid columns="2">
					<h:graphicImage value="/resources/images/icon/word.png" />
					<h:commandLink action="#{reporteBackingBean.downloadWord}" id="cl2"
						value="#{msg.label_descargar_word_generado}"
						onblur="p_down_word.hide();" style="text-decoration:underline;" />
				</h:panelGrid>
			</p:dialog>

			<!-- dialogo de descarga excel -->
			<p:dialog id="popUpDownExcel" header="#{msg.label_descargar}"
				widgetVar="p_down_excel" width="300" height="50" modal="false"
				draggable="false" resizable="false">
				<h:panelGrid columns="2">
					<h:graphicImage value="/resources/images/icon/excel_16x16.png" />
					<h:commandLink action="#{reporteBackingBean.downloadExcel}"
						id="cl1" value="#{msg.lavel_descargar_excel_generado}"
						onblur="p_down_excel.hide();" style="text-decoration:underline;" />
				</h:panelGrid>
			</p:dialog>


			<p:panel id="filtro_reporte_cuadro"
				header="#{msg.titulo_exportar_reportes}" toggleable="true"
				closable="false" toggleSpeed="500" closeSpeed="2000"
				widgetVar="panel">
				<h:panelGrid border="0" columns="3" style="width:335px;">
					<h:column headerClass="ancho250">
						<p:outputLabel value="#{msg.label_periodo}:" style="width:200px;"
							for="soc1" />
					</h:column>
					<h:column>
						<p:selectOneMenu id="soc1" label=" "
							unselectedLabel="#{msg.label_seleccione}"
							value="#{reporteBackingBean.filtroBackingBean.mes}"
							required="true">
							<f:selectItem itemLabel="#{msg.label_seleccione}" />
							<f:selectItems
								value="#{reporteBackingBean.componenteBackingBean.meses}"
								id="si1" />
						</p:selectOneMenu>
						<p:selectOneMenu id="soc2" label=" " style="margin-left:5px;"
							unselectedLabel="#{msg.label_seleccione}"
							value="#{reporteBackingBean.filtroBackingBean.anio}"
							required="true">
							<f:selectItem itemLabel="#{msg.label_seleccione}" />
							<f:selectItems
								value="#{reporteBackingBean.componenteBackingBean.anios}"
								id="si2" />
						</p:selectOneMenu>
						<h:message for="si1" styleClass="ui-outputlabel ui-state-error" />
					</h:column>
					<h:column>
						
					</h:column>
				</h:panelGrid>				
				<h:panelGrid columns="2">
					<p:outputLabel value="#{msg.label_tipo_cuadro}:" for="stc" />
					<p:selectOneMenu label="#{msg.label_tipo_cuadro}"
						converter="tipoCuadroConverter" id="stc"
						value="#{reporteBackingBean.filtroBackingBean.tipoCuadro}"
						required="false" requiredMessage="#{msg.mensaje_seleccione_valor}">
						<f:selectItem itemLabel="#{msg.label_seleccione}" />
						<f:selectItems
							value="#{reporteBackingBean.componenteBackingBean.tipoCuadroItems}" />
					</p:selectOneMenu>					
				</h:panelGrid>
				<h:panelGrid columns="3">
						<h:outputLabel value=" " />
						<p:commandButton value="#{msg.boton_buscar}" icon="ui-icon-search"
							action="#{reporteBackingBean.buscarAction}"
							update="tabla_catalogo_export" ajax="false">
						</p:commandButton>
						<p:commandButton icon="ui-icon-cancel" value="#{msg.boton_cancel}"
										 id="btnCancelar11" immediate="true"
						                 action="exportar-cuadro?faces-redirect=true">
						</p:commandButton>
					</h:panelGrid>
			</p:panel>
			<br />
			<p:toolbar rendered="#{reporteBackingBean.renderCatalogoReportes}">
				<p:toolbarGroup>
					<p:commandButton value="#{msg.label_exportar_a_word}" id="wordbtn1"
						icon="ui-icon-word" action="#{reporteBackingBean.generarDocx}">
					</p:commandButton>
					<p:separator />
					<p:commandButton value="#{msg.label_exportar_a_excel}" id="excbtn1"
						icon="ui-icon-xls" action="#{reporteBackingBean.generarExcel}">
					</p:commandButton>
					<p:separator />
					<p:commandLink value="#{msg.label_seleccionar_todo}"
						onclick="selectAll()"></p:commandLink>
					<p:separator />
					<p:commandLink value="#{msg.label_no_seleccionar_todo}"
						onclick="unSelectAll()"></p:commandLink>
				</p:toolbarGroup>
			</p:toolbar>
			<p:dataTable value="#{reporteBackingBean.catalogoReportes}"
				emptyMessage="#{msg.mensaje_tabla_sin_registros}"
				id="tabla_catalogo_export" var="row" lazy="true"
				rendered="#{reporteBackingBean.renderCatalogoReportes}"
				selectionMode="single" rowKey="#{row.entity.catalogo.idCatalogo}">
				<p:column sortable="true" headerText="#{msg.label_seleccionar}"
					id="c2" style="text-align:center;">
					<h:selectBooleanCheckbox value="#{row.selected}" id="sel1"
						label=" " />
				</p:column>
				<p:column headerText="#{msg.label_nombre}" align="start" id="c3">
					<h:outputText value="#{row.entity.catalogo.nombre}" id="ot3" />
				</p:column>
				<p:column headerText="#{msg.tabla_cabecera_titulo}" id="c4">
					<h:outputText value="#{row.entity.catalogo.titulo}" id="ot4" />
				</p:column>
				<p:column headerText="#{msg.label_tipo_de_impresion}" id="c1">
					<f:facet name="header">
						<h:selectOneMenu label="#{msg.label_tipo_de_impresion}:"
							id="cmb_tc5" required="false"
							value="#{reporteBackingBean.tipoImpresionHeader}">
							<f:selectItems
								value="#{reporteBackingBean.componenteBackingBean.tipoImpresionItems}"
								id="tipos_c5" />
							<p:ajax listener="#{reporteBackingBean.tipoImpresionChange}"
								update="tabla_catalogo_export" />
						</h:selectOneMenu>
					</f:facet>
					<h:selectOneMenu label="#{msg.label_tipo_de_impresion}:" id="soc3"
						value="#{row.entity.catalogo.impresionHorizontal}"
						required="false">
						<f:selectItems
							value="#{reporteBackingBean.componenteBackingBean.tipoImpresionItems}"
							id="si1" />
					</h:selectOneMenu>
				</p:column>
				<p:column sortable="false" headerText="#{msg.label_version}"
					align="right" id="c8">
					<h:outputText value="#{row.entity.version}" id="ot8" />
				</p:column>
				<!--af:column sortable="false" headerText="Periodo" align="right" id="c9">
                        <af:outputText value="#{row.entity.periodo.anioPeriodo}-#{row.entity.periodo.mesPeriodo}"
                                       id="ot8_1"/>
                    </af:column-->
				<p:column sortable="false" headerText="#{msg.label_vigencia}"
					align="start" id="c10" sortProperty="entity.vigencia" width="70">
					<h:outputText value="#{row.entity.vigencia eq 1 ? 'SI' : 'NO'}"
						id="ot10" />
				</p:column>
				<f:facet name="footer">
					<br />
				</f:facet>
			</p:dataTable>
		</h:form>
	</ui:define>
</ui:composition>
