<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	template="/WEB-INF/templates/main-template.xhtml">

	<ui:define name="content">

	
		<h:form id="form">
			<p:messages id="messages" autoUpdate="true" globalOnly="true" />
			<p:ajaxStatus onstart="statusDialogNoModal.show();"
				oncomplete="statusDialogNoModal.hide();" />
			<ui:include src="/WEB-INF/templates/ajax-dialog-template.xhtml" />

			<p:panel id="filtro" header="#{menuBackingBean.breadcrumb}"
				toggleable="true" closable="false" toggleSpeed="500"
				closeSpeed="2000" widgetVar="panel">
				<h:panelGrid columns="3" cellpadding="10" border="0">
					<p:selectOneMenu id="sol1" required="true"
						unselectedLabel="#{msg.general_control_seleccione}"
						value="#{navegadorTaxonomiaBackingBean.filtroBackingBean.xbrlTaxonomia}"
						converter="xbrlTaxonomiaConverter">
						<f:selectItems
							value="#{navegadorTaxonomiaBackingBean.xbrlTaxonomiasSelectItem}"
							id="si1" />
					</p:selectOneMenu>
					<p:commandButton value="Buscar"
						actionListener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.buscarTaxonomia}"
						update="@form"></p:commandButton>
					<p:commandButton value="Limpiar" action="mapping-taxonomia-ee-ff"
						immediate="true"></p:commandButton>







				</h:panelGrid>
			</p:panel>

			<p:fieldset
				rendered="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.renderMappingPanel}">

				<p:commandButton value="Auto Mapping"
					actionListener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.generarMappingAutomatico}"
					update="panelGroup" />
				<p:commandButton
					actionListener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.guardarMapeo}"
					value="Guardar" />


			</p:fieldset>
			<p:spacer height="10"></p:spacer>



			<h:panelGrid columns="2" width="100%" id="panelGroup"
				rendered="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.renderMappingPanel}">
				<p:layout fullPage="false" id="ly1" style="min-height:800px">
					<p:layoutUnit position="west" header="Left" resizable="true"
						closable="false" size="800" collapsible="true">

						<p:selectOneMenu label="Informe de Estados Financieros:"
							value="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.parentTaxonomia}">
							<f:selectItems
								value="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.taxonomyParentItems}"
								id="si5" />
							<p:ajax event="change" update="panelGroup"
								listener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.taxonomyParentChangeListener()}" />
						</p:selectOneMenu>

						<p:treeTable id="arbolConceptos"
							value="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.rootConcept}"
							var="nodo" selectionMode="multiple" selection="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.selectedConcepts}">
							<f:facet name="header">
									Conceptos
								</f:facet>

							<p:column>
								<f:facet name="header">Etiqueta</f:facet>
								<h:outputText value="#{nodo.label}" />
							</p:column>

							<p:column>
								<f:facet name="header">Id</f:facet>
								<h:outputText value="#{nodo.id}" />
							</p:column>

							<p:column>
								<f:facet name="header">Tipo</f:facet>
								<h:outputText value="#{nodo.type}" />
							</p:column>

							<p:column>
								<f:facet name="header">Codigo</f:facet>
								<h:outputText value="#{nodo.codigo}" />
							</p:column>

						</p:treeTable>
					</p:layoutUnit>

					<p:layoutUnit position="north" >


						<p:panelGrid columns="2">
							<p:commandButton value="Mapear" actionListener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.mapearConceptosEEFF}" update="listEEFF" />
							<p:commandButton value="Quitar" actionListener="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.quitarConceptosEEFF}" update="listEEFF" />
						</p:panelGrid>


					</p:layoutUnit>

					<p:layoutUnit position="center" resizable="true" collapsible="true">



						<p:dataTable id="listEEFF" var="e"
							rowKey="#{e.key}"
							selection="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.selectedconceptMapping}" selectionMode="single"
							value="#{mapeadorTaxonomiaEstadosFinancierosBackingBean.mappingFilter}">
							<p:column headerText="Codigo">
								<h:outputText value="#{e.estadoFinanciero.fecuFormat}" />
							</p:column>

							<p:column headerText="Descripcion">
								<h:outputText
									value="#{e.estadoFinanciero.codigoFecu.descripcion}" />
							</p:column>

							<p:column headerText="Monto">
								<h:outputText value="#{e.estadoFinanciero.montoTotal}" />
							</p:column>

							<p:column headerText="Concepto Valor">
								<ul>
									<ui:repeat var="v" value="#{e.conceptsValue}">
										<li>#{v}</li>
									</ui:repeat>
								</ul>

							</p:column>

							<p:column headerText="Concepto Miembro">
								<ul>
									<ui:repeat var="v" value="#{e.conceptsMember}">
										<li>#{v}</li>
									</ui:repeat>
								</ul>

							</p:column>

						</p:dataTable>
					</p:layoutUnit>
				</p:layout>
			</h:panelGrid>
		</h:form>
	</ui:define>
</ui:composition>
