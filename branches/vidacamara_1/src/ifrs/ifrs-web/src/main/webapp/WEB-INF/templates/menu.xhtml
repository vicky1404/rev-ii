<?xml version="1.0" encoding="ISO-8859-1"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.org/ui"
	xmlns:c="http://java.sun.com/jsp/jstl/core">
	<h:form id="form_menu" acceptcharset="ISO-8859-1">
		<!-- p:growl id="growl" autoUpdate="true"  /-->
		<p:ajaxStatus onstart="statusDialog.show();"
			oncomplete="statusDialog.hide();" />
		<ui:include src="/WEB-INF/templates/ajax-dialog-template.xhtml" />
		<p:panel
			header="#{menuBackingBean.renderSelectorEmpresa == true ? msg.label_seleccione_empresa : msg.label_empresa}">
			<p:selectOneMenu id="somEmp1" value="#{menuBackingBean.idRut}"
				valueChangeListener="#{menuBackingBean.empresaChangeValue}"
				rendered="#{menuBackingBean.renderSelectorEmpresa}" effect="fade">
				<f:selectItem itemLabel="#{msg.label_seleccione}" />
				<f:selectItems value="#{menuBackingBean.empresaList}" var="empresa"
					itemValue="#{empresa.idRut}" itemLabel="#{empresa.nombre}" />
				<f:ajax execute="@this" render="@form" />
			</p:selectOneMenu>
			<h:outputText value="#{menuBackingBean.empresa.nombre}"
				rendered="#{!menuBackingBean.renderSelectorEmpresa}" />
		</p:panel>

		<p:accordionPanel activeIndex="#{menuBackingBean.activeTabIndex}"
			id="ap_menu">
			<p:tab title="#{msg.label_tab_proceso}" id="m1"
				>
				<p:tree id="treeSingle" value="#{menuBackingBean.root}" var="nodo"
					selectionMode="single"
					style="border: 0px; width:95%; margin-left:-30px; float:left;">
					<p:ajax event="select" update="@form"
						listener="#{menuBackingBean.onSelectNodeMenuCuadro}" />
					<p:treeNode>
						<p:commandLink onclick="statusDialog.show();"
							onstart="statusDialog.show();" oncomplete="statusDialog.hide();"
							ajax="true" update="@form"
							value="#{menuBackingBean.catalogoMap[nodo].nombre == null ? nodo : menuBackingBean.catalogoMap[nodo].nombre}" >
							
							</p:commandLink>
					</p:treeNode>
				</p:tree>
			</p:tab>

			<c:forEach items="${menuBackingBean.menuModelList}" var="row"
				varStatus="status">
				<p:tab title="#{row.menuParent.nombre}" id="m2_${status.count}">
					<ul>
						<ui:repeat var="rowChild" value="#{row.menuChild}">
							<li style="margin-left: -40px;"><h:commandLink id="cl1"
									value="#{rowChild.nombre}"
									action="#{menuBackingBean.navigation}"
									style="text-decoration: none;"
									onmouseover="javascript:this.style.color='SlateGray';"
									onmouseout="javascript:this.style.color='black';">
									<f:param name="urlAction" value="#{rowChild.urlMenu}" />
									<f:param name="tabNumber" value="${status.count}" />
									<f:param name="breadcrumb"
										value="#{row.menuParent.nombre} > #{rowChild.nombre}" />
								</h:commandLink></li>
						</ui:repeat>
					</ul>
				</p:tab>
			</c:forEach>

		</p:accordionPanel>
	</h:form>
</ui:composition>